{% load static %} 
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <title>Title</title>
    <style>
            *{
                margin: 0px;
                padding: 0px;
            }
            html, body {
                height: 100%;
    
            }
            </style>
        <!-- 디자인 링크 받는곳 -->
        <title>Bootstrap Example</title>
        <meta charset="utf-8">
        <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
        <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script> -->
        <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<style>
    .label {margin-bottom: 96px;}
    .label * {display: inline-block;vertical-align: top;}
    .label .left {background: url("https://t1.daumcdn.net/localimg/localimages/07/2011/map/storeview/tip_l.png") no-repeat;display: inline-block;height: 24px;overflow: hidden;vertical-align: top;width: 7px;}
    .label .center {background: url(https://t1.daumcdn.net/localimg/localimages/07/2011/map/storeview/tip_bg.png) repeat-x;display: inline-block;height: 24px;font-size: 12px;line-height: 24px;}
    .label .right {background: url("https://t1.daumcdn.net/localimg/localimages/07/2011/map/storeview/tip_r.png") -1px 0  no-repeat;display: inline-block;height: 24px;overflow: hidden;width: 6px;}
</style>
</head>



<body> 
    <!-- <div s> -->
    <div id='navi_' style="position: absolute; z-index: 5;">    
            
        <!-- <section> -->

           
           <div class='navi_' style="position: absolute; z-index: 5;"> 
            <section> 
                <div class = 'navi_bar' style="overflow: auto; position: absolute; z-index: 10;">
                    <span >
                        
                        <nav class="navbar navbar-light bg-light">
                            <div class="container-fluid">
                                <a class="navbar-brand" href="#">
                                    <img src="/static/img/apt.png" alt="" width="30" height="24" class="d-inline-block align-text-top">
                                    융프라우
                                </a>
                            
                                <form class="d-flex">
                                    <input class="form-control me-2" type="search" placeholder="오이소 보이소 사이소" aria-label="Search">
                                    <!-- <button class="btn btn-outline-success" type="submit">사이소</button> -->
                                    <button>사이소</button>
                                </form>
    
    
                                <nav class="test" >
                        <!-- <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                                    <span class="navbar-toggler-icon">CLICK</span> -->
                                    <div>   
                                        <li>상위 카테고리
                                            
                                                <p>하위 카테고리01</p>
                                                <li>하위 카테고리02</li>
                                                <li>하위 카테고리03</li>
                                                <li>하위 카테고리04</li>
                                                <li>하위 카테고리05</li>
                                                <li>하위 카테고리06</li>
                                                <li>하위 카테고리07</li>
                            
                                    
                                        </li>    
                                        
                                    </div>
                                <!-- </nav>                             -->
    
                            </div>
                        </nav>
                    </span>
                
                    <div id = "chart" >
                        <div >
                            <canvas id="myChart"></canvas>
                        </div>                
    
                </div>
                
                <script>
    
                    //apt 실거래 데이터 받아오기
                    
                    var apt = JSON.parse("{{ apt_Json|escapejs }}");
    
    
                    console.log(apt)
                    var apt_name = new Array();
                    var apt_price = new Array();
                    var apt_year = new Array();
    
    
                    for(i=0;i<apt.length;i++){
                        // console.log(apt[i])
                        // console.log(i)
                        var d = apt[i];
                        apt_name.push(d.name);
                        apt_price.push(d.price);
                        apt_year.push(d.year)
                    }
                    console.log(apt_name)
                    console.log(apt_price)
                    console.log(apt_year)
    
    
    
                    var ctx = document.getElementById("myChart").getContext('2d');
    
    
                    //chart js
                    var myChart = new Chart(ctx,{
                            type: 'line',
                            data: {
                                labels: apt_year,
                                datasets: [{
                                    label: '테스트 데이터셋',
                                    data: apt_price,
                                    borderColor: "rgba(255, 201, 14, 1)",
                                    backgroundColor: "rgba(255, 201, 14, 0.5)",
                                    fill: true,
                                    lineTension: 0
                                }]
                            },
                            options: {
                                responsive: true,
                                title: {
                                    display: true,
                                    text: '라인 차트 테스트'
                                },
                                tooltips: {
                                    mode: 'index',
                                    intersect: false,
                                },
                                hover: {
                                    mode: 'nearest',
                                    intersect: true
                                },
                                scales: {
                                    xAxes: [{
                                        display: true,
                                        scaleLabel: {
                                            display: true,
                                            labelString: apt_name[0]
                                        }
                                    }],
                                    yAxes: [{
                                        display: true,
                                        ticks: {
                                            suggestedMin: 0,
                                        },
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'price of year'
                                        }
                                    }]
                                }
                            }
                        });
    
                </script>
               </div> 
            </section>    
        </div>

                
                <script >

                // var apt = JSON.parse("{{ apt_Json|escapejs }}");
                // // console.log(apt)
                // var apt_name = new Array();
                // var apt_price = new Array();
                // var apt_year = new Array();


                // for(i=0;i<apt.length;i++){
                //     // console.log(apt[i])
                //     // console.log(i)
                //     var d = apt[i];
                //     apt_name.push(d.name);
                //     apt_price.push(d.price);
                //     apt_year.push(d.year)
                // }
                // console.log(apt_name)
                // console.log(apt_price)
                // console.log(apt_year)
                // 우선 컨텍스트를 가져옵니다. 
                /*
                - Chart를 생성하면서, 
                - ctx를 첫번째 argument로 넘겨주고, 
                - 두번째 argument로 그림을 그릴때 필요한 요소들을 모두 넘겨줍니다. 
                */
                    // const json = "/static/json/sample.json"
                    // var j_d = JSON.parse(json);
                    // console.log(j_d.length)

                    // var j;
                    // function getData(){
                         
                    //      $.getJSON("/static/json/sample.json", function(data) {
                                
                    //         j = data;
                    
                    //     });
                    //     return j;

                    // }

                    // function getData(callbackFunc) {
                    //     j = $.get("/static/json/sample.json", function (response) {
                    //         callbackFunc(response); // 서버에서 받은 데이터 response를 callbackFunc() 함수에 넘겨줌
                    //     });
                    // }

                    

                    // getData(function (data) { 
                    //     for(var i=1;i<data.length;i++)
                    //     {   
                    //         // console.log(data[i].gu);
                    //         if((data[i].name == '시청역SKVIEW' && (data[i].dong == '연산동'))){
                    //             console.log(data[i]);
                    //         }
                    //         // console.log(data[i]);
                    //     }
                        
                    // });
                        
                    
                    
                    // $.get("/static/json/sample.json", function(data) {
                    //     // 데이터에서 좌표 값을 가지고 마커를 표시합니다
                    //     // 마커 클러스터러로 관리할 마커 객체는 생성할 때 지도 객체를 설정하지 않습니다
                    //     var markers = $(data.positions,function(i, position) {
                    //         return 
                    //     });

                    //     // 클러스터러에 마커들을 추가합니다
                    //     clusterer.addMarkers(markers);
                    // });

                    // var j = $.get("/static/json/sample.json" )
                    //     .done(function( data ) {
                    //     // document.write( "data: " + data );
                    //     // return data
                    //     console.log(typeof(data))
                    // });
                    // console.log(j)
                    // console.log(j.responseJSON)
                // var apart_json_d = JSON.stringify()




                </script>
                </div>
            </div>
            
        



    </div>
    
    <div id="map" style="z-index: 3;position: relative;" >
        <!-- <div id="map" style="position: relative; overflow: hidden; background: url("https://ssl.pstatic.net/static/maps/mantle/1x/pattern_1.png") 0px 0px repeat transparent;"></div> -->
        
        <!-- <div>
            <div id="map" style="width:80%;height:700px;"></div>
        </div> -->

   
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=bc739a82bf6e98760fac5b9463dbe1da"></script>
    
   


        <script>
            var mapContainer = document.getElementById('map'), // 지도를 표시할 div  
                mapOption = { 
                    center: new kakao.maps.LatLng(35.1791552,129.0730083), // 지도의 중심좌표
                    level: 4 // 지도의 확대 레벨
                };
            
            var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다


    
            // 아파트에 대한 정보
            // 커스텀오버레이를 지도에 띄울 정보
            var apt = [
                {
                    title: '연제현대힐스테이트아파트', 
                    latlng: new kakao.maps.LatLng(35.1764482,129.0747028),
                    price: '100억'
                },
                {
                    title: '거제유림노르웨이숲아파트', 
                    latlng: new kakao.maps.LatLng(35.179667, 129.070767),
                    price: '11억'
                },
                {
                    title: '백조아파트', 
                    latlng: new kakao.maps.LatLng(35.174230, 129.070402),
                    price: '9.5억'
                },
                {
                    title: '시청역SKVIEW',
                    latlng: new kakao.maps.LatLng(35.1815772,129.0759095),
                    price: '11.5억'
                }
            ];

            
            // 지도에 커스텀오버레이로 아파트를 보여줍니다
            for (var i = 0; i < apt.length; i ++) {

                displayApt(apt[i]);


            }

            function displayApt(apt){

                // 커스텀 오버레이를 생성합니다
                var customOverlay = new kakao.maps.CustomOverlay({
                    position: apt.latlng,
                    content: '<div class ="label"><span class="left"></span><span class="center">'+apt.title+'</span><span class="right"></span></div>'
                });

                // 커스텀 오버레이를 지도에 표시합니다
                customOverlay.setMap(map);
            }
        </script>
        
    </div>
    
</body>
</html>

